<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title> Research  – Praveen Punia</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>


</head>

<body class="nav-fixed fullcontent">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Praveen Punia</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../research/index.html" aria-current="page"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../teaching/index.html"> 
<span class="menu-text">Teaching</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../cv/index.html"> 
<span class="menu-text">CV</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"></h1><h1 style="text-align: center;"><br>
Research<br>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<style>
.paper-entry {
  margin-bottom: 2em;
  position: relative;
}

.paper-entry-content {
  margin-bottom: 0.5em;
}

.divider {
  border-bottom: 1px solid #e0e0e0;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

.arrow-container {
  text-align: right;
  position: relative;
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

details summary {
  list-style: none;
}

details summary::-webkit-details-marker {
  display: none;
}
</style>
<section id="working-papers" class="level1">
<h1>Working Papers</h1>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“How Does Sales Experience Affect Life Satisfaction?”</strong> <strong>(Preparing for submission)</strong> with Michael Ahearne, Arpit Agrawal, and Johannes Habel.</p>
<p><em>Awards: 2025 Sales SIG Doctoral Dissertation Proposal Award Winner</em><br>
<em>Accepted at MSI Working Paper Series</em></p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
Business-to-business (B2B) sales is perhaps the most ambivalent career the marketing discipline offers, entailing extreme advantages and disadvantages that might change individuals’ lives for the better or worse. Thus, it is unclear how experience in a B2B sales role impacts an individual’s life satisfaction, a terminal outcome of utmost importance given our pursuit of better marketing for a better world. We test this effect in three studies including cross-sectional data of 64,090 individuals, longitudinal panel data of over 12,500 individuals, and qualitative interviews with salespeople. Interestingly, we find that having experience in a B2B sales role on average enhances life satisfaction. This is because sales experience equips individuals with distinct interpersonal skills that they use to find greater satisfaction outside the work context, such as helping others, enforcing own interests, and building social relationships. The effect of sales experience on life satisfaction is more positive for individuals with a plastic personality, who are more likely to gain and transfer skills. Thereby, this study adds a neglected antecedent to life satisfaction theory and offers actionable implications for managers and educators on improving life satisfaction within organizations and society at large.
</details>
</div>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“So Near Yet So Far: The Impact of Near Misses on Salesperson Turnover”</strong> <strong>(Invited for 3rd round revision at Journal of Marketing Research)</strong> with Michael Ahearne, Arpit Agrawal, Yashar Atefi, and Johannes Habel.</p>
<p><em>Awards: Best Paper Award at 2024 OFR Symposium, Sales Management Track at 2024 AMA Winter Academic Conference</em></p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
The role of sales is unique within organizations, marked by its high-profile nature and objective performance metrics. Meeting sales targets is vitally important for salespeople, and failure to do so can lead to significant frustration. It is well-established that quota attainment is a key factor influencing a salesperson’s decision to quit. Research consistently shows that the lower the quota attainment, the higher the likelihood of the salesperson quitting. However, our study offers a new perspective and adds a subtle complexity to this understanding. Drawing from the concept of counterfactual thinking, we propose that salespeople who narrowly miss sales targets are more likely to quit, even if they are generally high performers. We examine this with two studies: 1) a panel dataset of over 2,900 retail salespeople and 2) cross-industry data on over 25,000 salespeople. Our results confirm that repeated quota near misses cause turnover and reveal three sources of heterogeneity: the effect of quota near misses on turnover increases with higher variable pay percentage and decreases with higher maximum possible pay and higher group performance diversity. Our findings extend sales force turnover theory and provide actionable implications for managers who aim at reducing turnover.
</details>
</div>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“Unemployment and Service Quality”</strong> (Preparing for submission to Management Science) with Michael Ahearne, Johannes Habel, and Jim Hess.</p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
It is well established that service employees decisively shape service quality. Therefore, research has clarified how service firms should manage these employees, typically conceiving of them as a generally available and controllable resource. However, this general viewpoint faces severe limitations considering recent labor market disruptions, which pose severe challenges for service firms filling vacant positions. Building on this observation, we propose a theoretical model to explore the role of labor market and wages on expected service quality at a facility. Our model predicts that higher unemployment rates improve service quality by reducing employee turnover, higher wages enhance service quality through increased effort, with these effects demonstrating a significant negative interaction. Additionally, we predict these factors have a negative interaction, whereby high-wage facilities experience less benefit from rising unemployment than their low-wage counterparts. We empirically validate these predictions using two natural experiments in a retailing and fast-food restaurant context. The results suggest that as unemployment falls and labor supply becomes shorter, service quality decreases. Intriguingly, this effect particularly emerges for service firms that offer lower wages, while service firms that offer higher wages maintain their service quality levels. We discuss in detail how to evolve service quality theory based on these findings. Furthermore, we offer actionable guidance to managers and policymakers on how to safeguard service quality as the war for talent rages on.
</details>
</div>
</section>
<section id="work-in-progress" class="level1">
<h1>Work In Progress</h1>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“A Predictive Framework for Forecasting Long-Term Video Game Performance Using Key Launch Period Metrics”</strong> with Sam Hui and Rahul Suhag.</p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
When analyzing early performance signals on digital platforms, it is important for firms to understand how initial engagement metrics predict long-term revenue. We introduce a Temporal Fusion Transformer (TFT) framework that models the relationship between early-stage behavioral patterns and future value generation in environments with high temporal volatility. We propose a multi-head attention architecture that combines static characteristics with time-varying characteristics to forecast revenue trajectories. The model employs variable selection networks to identify relevant predictors from high-dimensional temporal data, while multi-horizon forecasting capabilities capture both immediate trends and long-term temporal dependencies. By processing known historical patterns through encoder-decoder structures, the TFT generates probabilistic predictions that account for heterogeneous lifecycle trajectories. We demonstrate this approach through an application to livestreaming platforms, where game revenue predictions based on early performance metrics inform promotion and investment decisions. Using daily game-level data from major Asian platforms, we show how managers can leverage temporal fusion mechanisms to optimize resource allocation under uncertainty. This results in more accurate revenue predictions and outperforms traditional forecasting approaches such as ARIMA models and gradient boosting methods. Beyond livestreaming, our temporal fusion framework provides a generalizable solution for forecasting long-term outcomes from early indicators across other domains.
</details>
</div>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“AI-Human Collaboration in B2B Sales Negotiations”</strong></p>
<p><em>Awards: 2025 Lisa Scheer Best Early-Stage Research Proposal</em></p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
In B2B sales negotiations where multi-stakeholder dynamics and trust are critical salespeople face challenges processing vast data and adapting strategies in real time. AI offers potential to enhance these capabilities but raises concerns about trust and alignment with human judgment. To explore AI’s role in this context, we ask three critical questions: (1) How do AI agents balance efficiency and relationship-building in B2B sales negotiations? (2) What mechanisms explain AI’s impact on social coordination costs and strategic decision-making in iterative negotiations? (3) How can prompt engineering align AI personas with salespeople traits to optimize collaboration and outcomes? We aim to develop SalesSynergy a custom platform enabling human-AI collaboration in simulated and real-world negotiation. We employ a mixed- methods approach with 2 interconnected studies. First, a controlled experiment with sales professionals randomly assigned to different conditions will complete negotiation tasks. Second, using a quasi-experimental design in a field study with a B2B firm to validate findings using real negotiations. By extending negotiation theory and human-AI collaboration frameworks, this research offer actionable frameworks for sales practitioners and AI developers while advancing academic understanding of AI-augmented negotiations in B2B.
</details>
</div>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“Build vs.&nbsp;Acquire: The Impact of Internal vs.&nbsp;External Sales Hiring on Firm Performance”</strong> with Michael Ahearne, Johannes Habel, and Jim Hess.</p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
In business-to-business (B2B) sales, firms face critical decisions about salesforce compensation and skill development that significantly impact performance. This paper examines two key questions: (1) What are the performance implications of hiring salespeople internally versus externally? And (2) Among the salespeople hired internally versus externally who are like to stay longer with the firm? We develop an analytical model that captures the key trade-offs in these decisions and test it using a unique dataset of 40 companies. For hiring source decisions, we show that while internal hires initially outperform due to firm-specific knowledge, external hires exhibit steeper learning curves and may eventually match or exceed internal hire performance. Our empirical analysis validates these theoretical predictions and quantifies the magnitude of these effects across different industry contexts. The findings provide actionable insights for sales managers making hiring decisions under uncertainty, while contributing to theories of salesforce management and human capital development.
</details>
</div>
<div class="paper-entry">
<div class="paper-entry-content">
<p><strong>“Freedom Isn’t Free: How Self-Employment Reshapes Work, Health, and Happiness”</strong> with Michael Ahearne and Johannes Habel.</p>
</div>
<div class="arrow-container">
▼
</div>
<div class="divider">

</div>
<details>
<summary>
</summary>
Self-employment represents a fundamental trade-off between autonomy and personal well-being, yet its impact on individuals’ lives remains incompletely understood. This research examines three critical questions: (1) How does transitioning to self-employment affect key life outcomes including income, work hours, life satisfaction, job satisfaction, health satisfaction, and leisure time? (2) How do individual characteristics—specifically gender and age—moderate these relationships? (3) How does business size influence the trade-offs between economic success and personal well-being in self-employment? Using longitudinal data from the German Socio-Economic Panel (SOEP) tracking over 92,000 individuals. Our findings reveal that self-employment improves job satisfaction and life satisfaction but creates significant trade-offs, particularly around work hours, leisure time, and health. The effects are strongly moderated by gender – with men experiencing higher income gains but worse health outcomes, while women achieve better work-life balance at the cost of lower earnings. Age and business size further moderate these relationships, with older entrepreneurs and those managing smaller ventures better able to preserve work-life balance. These results enhance our understanding of how entrepreneurship shapes individual well-being and highlight important boundary conditions around gender, age, and organizational context. The findings have implications for theories of occupational choice and work-life balance, while offering practical insights for potential entrepreneurs and policymakers.
</details>
</div>
<script>
document.addEventListener('DOMContentLoaded', function() {
  // For each arrow container, make it toggle the associated details element
  const arrows = document.querySelectorAll('.arrow-container');
  arrows.forEach(arrow => {
    arrow.addEventListener('click', function() {
      const container = this.closest('.paper-entry');
      const details = container.querySelector('details');
      details.open = !details.open;
      this.textContent = details.open ? '▲' : '▼';
    });
  });
});
</script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/praveenpunia\.github\.io");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p><span class="faux-block">© 2025 Praveen Punia CC BY-SA 4.0</span></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>